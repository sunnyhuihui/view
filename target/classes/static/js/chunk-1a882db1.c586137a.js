(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1a882db1"],{"4d59":function(t,e,r){"use strict";var a=r("589f"),o=r.n(a);o.a},5290:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"wrapper"},[r("div",{staticClass:"table-title"},[r("Row",{staticStyle:{display:"flex","align-items":"center"}},[r("i-col",{staticClass:"title-text",attrs:{span:"3"}},[r("Icon",{attrs:{type:"md-clipboard",color:"rgb(7, 1, 1)",size:"20"}}),t._v("工单管理\n      ")],1)],1)],1),r("Row",{staticStyle:{"margin-bottom":"-5px"}},[r("i-col",{attrs:{offset:"1"}},[r("Form",{ref:"formInline",attrs:{model:t.searchForm,inline:""}},[r("FormItem",{attrs:{prop:"oid",label:"工单Id","label-width":70}},[r("Input",{staticStyle:{width:"120px"},attrs:{type:"text",clearable:"",placeholder:"工单Id"},model:{value:t.searchForm.oid,callback:function(e){t.$set(t.searchForm,"oid",e)},expression:"searchForm.oid"}})],1),r("FormItem",{staticStyle:{width:"200px"},attrs:{prop:"status",label:"工单状态","label-width":70}},[r("Select",{attrs:{placeholder:"请选择工单状态"},model:{value:t.searchForm.status,callback:function(e){t.$set(t.searchForm,"status",e)},expression:"searchForm.status"}},[r("Option",{attrs:{value:"-1"}},[t._v("全部")]),r("Option",{attrs:{value:"0"}},[t._v("生成工单")]),r("Option",{attrs:{value:"1"}},[t._v("已指派")]),r("Option",{attrs:{value:"2"}},[t._v("修复中")]),r("Option",{attrs:{value:"3"}},[t._v("完成")])],1)],1),r("FormItem",{attrs:{prop:"title",label:"工单标题","label-width":70}},[r("Input",{attrs:{type:"text",clearable:"",placeholder:"工单标题"},model:{value:t.searchForm.title,callback:function(e){t.$set(t.searchForm,"title",e)},expression:"searchForm.title"}})],1),r("FormItem",{attrs:{prop:"time",label:"时间段","label-width":60}},[r("DatePicker",{attrs:{type:"daterange",placeholder:"选择时间段"},model:{value:t.searchForm.time,callback:function(e){t.$set(t.searchForm,"time",e)},expression:"searchForm.time"}})],1),r("FormItem",{attrs:{prop:"phone",label:"工单生成者电话","label-width":110}},[r("Input",{attrs:{type:"text",clearable:"",placeholder:"电话"},model:{value:t.searchForm.phone,callback:function(e){t.$set(t.searchForm,"phone",e)},expression:"searchForm.phone"}})],1),r("FormItem",{attrs:{"label-width":30}},[r("Button",{attrs:{type:"primary"},on:{click:function(e){return t.getOrders(1)}}},[t._v("查询")])],1)],1)],1)],1),r("Table",{attrs:{stripe:"",border:"",columns:t.tableColumns,data:t.tableData}}),t.tableTotal>0?r("div",{staticClass:"pageSelect"},[r("Page",{attrs:{total:t.tableTotal,current:t.currentPage,"page-size":10},on:{"update:current":function(e){t.currentPage=e},"on-change":t.changePage}})],1):t._e()],1)},o=[],n=r("ed08"),i={name:"ConfigManage",data:function(){var t=this;return{tableColumns:[{type:"index",width:70,align:"center",title:"序号"},{title:"工单标题",key:"title",align:"center",width:150},{title:"工单ID",align:"center",key:"oid",width:80},{title:"工单生成者电话",align:"center",key:"phone",width:150},{title:"工单生成时间",align:"center",key:"createTime",width:200},{title:"工单更新时间",align:"center",key:"updateTime",width:200},{title:"工单描述",align:"center",key:"des",width:150,render:function(t,e){return t("Poptip",{props:{trigger:"click",title:"工单描述",placement:"bottom",content:e.row.des?e.row.des:"暂无"}},[t("Button",{props:{type:"dashed"}},"点击展开")])}},{title:"工单处理进度",align:"center",key:"status",width:150,render:function(e,r){return e("Poptip",{props:{trigger:"click",title:"工单处理进度",placement:"bottom-end"}},[e("Button",{props:{type:"dashed"}},"点击展开"),e("div",{slot:"content"},[e("Steps",{props:{current:r.row.status,size:"small"},style:{width:"500px"}},t.steps.map(function(t){return e("Step",{props:{title:t.title}})}))])])}},{title:"现场照片",align:"center",key:"img",width:150,render:function(e,r){return e("Button",{props:{type:"primary",disabled:!r.row.img},on:{click:function(){if(!r.row.img)return t.$Message.info({content:"没有现场图片",closable:!0});window.location.href=r.row.img}}},[e("span","查看"),e("Icon",{props:{type:"ios-arrow-forward"}})])}},{title:"现场视频",align:"center",key:"vedio",width:150,render:function(e,r){return e("Button",{props:{type:"primary",disabled:!r.row.vedio},on:{click:function(){if(!r.row.vedio)return t.$Message.info({content:"没有现场视频",closable:!0});window.location.href=r.row.vedio}}},[e("span","查看"),e("Icon",{props:{type:"ios-arrow-forward"}})])}},{title:"操作",key:"action",width:200,align:"center",fixed:"right",render:function(e,r){return e("div",[e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"10px"},on:{click:function(){t.updateOrder(r)}}},"更新工单进度"),e("Button",{props:{type:"error",size:"small"},on:{click:function(){t.$Modal.confirm({title:"是否删除该工单？",onOk:function(){t.removeOrder(r)}})}}},"删除")])}}],tableData:[],steps:[{title:"生成工单"},{title:"已指派"},{title:"修复中"},{title:"完成"}],searchForm:{oid:"",status:"",title:"",time:"",phone:""},selectOrder:"",partList:[{value:0,label:"生成工单"},{value:1,label:"已指派"},{value:2,label:"修复中"},{value:3,label:"完成"}],tableTotal:0,currentPage:1}},created:function(){this.getOrders(1)},methods:{getOrders:function(t){var e=this,r=new FormData;r.append("oid",this.searchForm.oid),r.append("status","-1"===this.searchForm.status?"":this.searchForm.status),r.append("title",this.searchForm.title),r.append("startTime",Object(n["c"])(this.searchForm.time[0])),r.append("endTime",Object(n["c"])(this.searchForm.time[1])),r.append("phone",this.searchForm.phone),r.append("pageNum",t),r.append("pageSize",10),this.$http.fetch("/api/workOrder/query",{method:"POST",body:r}).then(function(t){return t.json()}).then(function(r){if(-1001===r.code)return e.$Message.error({content:r.msg,closable:!0,onClose:function(){window.localStorage.removeItem("loginStatus"),window.localStorage.removeItem("userName"),window.localStorage.removeItem("priority"),window.localStorage.removeItem("setDriver"),e.$router.push("/login")}});var a=r.data.content;e.tableTotal=r.data.totalElements,e.currentPage=t,e.tableData=a.map(function(t,e){return{oid:t.oid,title:t.title,phone:t.phone,img:t.imageList[0],vedio:t.videoList[0],createTime:Object(n["c"])(t.createTime),updateTime:Object(n["c"])(t.updateTime),status:t.status,des:t.des}})}).catch(function(t){e.$Message.error({content:"查询失败",closable:!0})})},removeOrder:function(t){var e=this,r=t.row.oid,a=new FormData;a.append("ids",[].concat(r)),this.$http.fetch("/api/workOrder/deleteIn",{method:"POST",body:a}).then(function(t){return t.json()}).then(function(t){e.getOrders(1),e.$Message.success({content:"删除工单成功",closable:!0})}).catch(function(t){e.$Message.error({content:"删除工单失败",closable:!0})})},updateOrder:function(t){var e=this,r="";this.$Modal.confirm({title:"更新工单进度",render:function(a){return a("RadioGroup",{props:{value:t.row.status},on:{"on-change":function(t){r=t}}},e.partList.map(function(t){return a("Radio",{props:{label:t.value},style:{marginLeft:"5px",marginTop:"20px"}},[a("span",t.label)])}))},onOk:function(){var a=new FormData;a.append("oid",t.row.oid),a.append("status",r),e.$http.fetch("/api/workOrder/update",{method:"POST",body:a}).then(function(t){return t.json()}).then(function(t){e.getOrders(1),e.$Message.success({content:"更新工单进度成功",closable:!0})}).catch(function(t){e.$Message.error({content:"更新工单进度失败",closable:!0})})}})},changePage:function(t){this.getOrders(t)}}},s=i,l=(r("4d59"),r("17cc")),c=Object(l["a"])(s,a,o,!1,null,"7b7a3c86",null);e["default"]=c.exports},"589f":function(t,e,r){}}]);